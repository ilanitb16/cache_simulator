inputs for testing:

in:
8
1 2 3 4 5 6 7 8
1 1 1 1
0 1 0 1 2 3 4 2 3 5 6 7 1 0 4 -1

out:
Set 0
1 1 0x1 05 06
Set 1
1 2 0x1 07 08


in:
4
1 2 3 4
0 1 1 4
0 1 0 1 2 3 3 2 3 1 2 3 1 0 1 -1

out:
Set 0
1 8 0x0 01 02
1 7 0x1 03 04
0 0 0x0 00 00
0 0 0x0 00 00

in:
8
1 2 3 4 5 6 7 8
1 1 1 3
0 1 0 1 2 3 4 2 3 5 6 7 1 0 4 5 7 2 4 7 3 -1

out:
Set 0
1 6 0x0 01 02
1 5 0x1 05 06
0 0 0x0 00 00
Set 1
1 6 0x0 03 04
1 4 0x1 07 08
0 0 0x0 00 00


in:
8
1 2 3 4 5 6 7 8
0 2 1 3
0 1 0 1 2 3 4 2 3 5 6 7 1 0 4 5 7 2 4 5 3 -1

out:
Set 0
1 6 0x00 01 02
1 6 0x01 03 04
1 2 0x02 05 06


in:
16
2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17
2 1 1 4
0 1 0 1 2 2 1 2 4 1 2 4 4 2 3 3 2 0 2 4 1 3 -1

out:
Set 0
1 8 0x0 02 03
0 0 0x0 00 00
0 0 0x0 00 00
0 0 0x0 00 00
Set 1
1 10 0x0 04 05
0 0 0x0 00 00
0 0 0x0 00 00
0 0 0x0 00 00
Set 2
1 4 0x0 06 07
0 0 0x0 00 00
0 0 0x0 00 00
0 0 0x0 00 00
Set 3
0 0 0x0 00 00
0 0 0x0 00 00
0 0 0x0 00 00
0 0 0x0 00 00
